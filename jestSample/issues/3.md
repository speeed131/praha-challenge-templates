# ３−１

> 課題２の単体テストを書くためには、依存性の注入とモック化を行う必要がありました。そもそも、なぜ元の関数はカバレッジ100%のテストを書けなかったのでしょうか？

関数内で使用されるクラス・関数・ライブラリなどの実行結果に依存しているため。

# 3-2

> 依存性の注入とは何でしょうか？どのような問題を解決するために考案されたのでしょうか？

- 依存しているオブジェクトなどの生成を外部に委ねること。
- 解決すること
  - 実装を差し替えるたびに呼び出し元を改修する必要があったが、依存をインターフェース化して疎結合にすることができる
  - テスト時にモック実装を注入できることでテスタビリティが向上
  - 対象のクラスや関数が生成ではなく、ビジネスロジックに責務を集中できる

# 3-3

> 今回のような単体テストで外部サービスとの通信が発生すると、どのようなデメリットがあるでしょうか？

- 外部サービスの実行結果がテストの実行結果に影響してしまうことで、テストの安定性がなくなってしまう
  - APIの500エラーやネットワークの遅延などが影響する
- 外部状態に依存するため単体テストではない
- 速度が遅くなる

# 3-4

> 「何を単体テストと呼ぶのか」「何を統合テストと呼ぶのか」など用語の定義集を作ってみても面白いかもしれません。

# 3-5, 3-6

コード参照

# 3-7

> そんな時に役立つかもしれない概念として「Property Based Testing（プロパティベースのテスト）」があります（対照的な存在としてはExample Based Testingが挙げられます）。
> なぜこのテストの考え方がコード品質を向上してくれる可能性があるのでしょうか？ 逆に採用しない方が良いケースはあるのでしょうか？

- PBTとは入力値を大量自動生成し、その関数などのプロパティ（性質）が成立するか確かめるテスト手法
  - メリット
    - 多くの組み合わせをテストケースとして試せることで、開発者の想像外のテストケースが作成され、コード品質が向上される可能性がある
    - 少ないテスト記述で高網羅
  - 採用しないほうがいいケース
    - UIや複雑な状態管理が絡むケースで、テストの自動生成が難しい
    - EBTで簡潔にケースが満たされるなど、PBTでの実装コストが高いとき

# 3-8

- `__tests__/functions.test.ts` のようにdescribe で正常系、異常系などでグルーピングし、保守性を高める
- 共通のセットアップ処理を beforeEach で行う
  - テスト本体のまとめられるコード記述量を減らす
- 並列実行をさせることで実行速度を高める。Jestであれば`--maxWorkers`指定
